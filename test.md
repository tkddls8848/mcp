orchestrate_full_response
용도
⭐ 한국 공공 지원 상담의 메인 진입 도구입니다.
사용자가 상황을 설명하거나 지원을 요청할 때 가장 먼저 호출해야 하는 도구입니다.

호출 필수:
- 처음 상담을 시작할 때 (상황 설명, 지원 요청 등)
- 분야가 불명확하거나 여러 분야가 섞여 있을 때
- 위기 상황(성폭행, 가정폭력 등) 포함 모든 상황

⚠️ 호출 금지 (이 경우 rank_support_cards 사용):
- 특정 분야가 명시된 경우: "월세 지원", "주거 지원", "생활비 지원", "의료 지원" 등
- 분야 키워드 + 필요/절실 표현: "월세 지원이 필요해요", "고정지원이 절실해요"
- 분야 키워드 + 힘듦 표현: "주거가 너무 힘들어요", "생활비가 부족해요"
→ 이런 경우에는 사용자가 직접 분야를 선택한 것으로 간주하고,
해당 분야의 카드를 바로 제공하는 것이 더 적절합니다.

이 도구는:
①상황 요약 → ②분야 안내 → ③혜택 카드 2-3개 → ④행동 단계 →
⑤제도명(트리거 시) → ⑥확장 가능성 → ⑦감정 안전 메시지
를 자동으로 제공합니다.

파라미터
user_message: string
skip_onboarding: boolean
normalize_user_context
용도
한국 공공 지원 관련 사용자 발화를 구조화된 상황 정보로 정리.
호출 시점:
- orchestrate_full_response 대신 상황 분석만 먼저 필요할 때
- 사용자가 상황 설명은 했지만 아직 지원 요청은 하지 않았을 때
- 복잡한 상황을 단계적으로 분해하고 싶을 때

예시:
- "30대이고 서울에 살아요. 3년째 백수고 혼자 살아요" (상황만, 요청 없음)
- "결혼 준비 중인데 천안 두정동에 살고 있어요" (배경 정보만)

호출 금지:
- 이미 orchestrate_full_response를 호출한 경우 (중복 방지)
- 공공 지원과 무관한 일상 대화
- 단순 인사나 확인 응답

출력: summary(상황 요약), keywords(키워드 리스트), missing_info(부족한 정보)

파라미터
message: string
assess_urgency_level
용도
공공 지원 상황의 긴급도(1~3) 평가. 내부 로직용, 단독 호출 거의 불필요.
긴급도 기준:
- Level 1 (매우 긴급): 퇴거, 위험, 응급, 폭력 등 즉각 대응 필요
- Level 2 (긴급): 이번 달, 곧, 급한 등 단기 압박
- Level 3 (보통): 일반적인 지원 탐색 상황

호출 시점:
- orchestrate_full_response가 자동으로 처리함
- 개별적으로 긴급도만 판단할 때 (매우 드묾)

대부분의 경우:
- 단독 호출 불필요
- orchestrate_full_response가 자동 감지 및 대응
- 긴급도에 따라 카드 개수와 안전 메시지 자동 조정됨

출력: urgency_level(1, 2, 3)

파라미터
context: object
expose_available_domains
용도
사용자 상황에서 열려 있는 지원 분야 목록 제공 (한국 공공 지원).
핵심 분야: 주거·월세 | 생활 유지 | 의료·돌봄 | 고용·교육 | 심리·정서
확장 분야: 문화·여가 | 평생교육 | 참여·활동 (사용자 명시적 요청 시)

호출 시점:
- orchestrate_full_response가 ②단계에서 자동 포함
- 개별적으로 분야 목록만 보여줄 때 (드묾)
- "어떤 분야가 있어요?" 같은 분야 목록 질문

대부분의 경우:
- 단독 호출 불필요
- orchestrate_full_response 사용 권장
- 구체적인 상담은 orchestrate로 진행

출력: domains(분야 리스트), smart_suggestion(AI 추천 분야)

rank_support_cards
용도
특정 지원 분야의 혜택 카드 2-3개 제공 (한국 공공 지원).
⚠️ 중요: 특정 분야가 명시된 경우 바로 이 도구를 사용하세요.
orchestrate_full_response를 거치지 않고 바로 호출 가능합니다.

핵심 분야: 주거·월세 | 생활 유지 | 의료·돌봄 | 고용·교육 | 심리·정서
확장 분야: 문화·여가 | 평생교육 | 참여·활동 (사용자 명시적 요청 시)

호출 시점:
- 분야 키워드 + 필요/절실 표현: "월세 지원이 필요해요", "고정지원이 절실해요"
- 분야 키워드 + 힘듦 표현: "주거가 너무 힘들어요", "생활비가 부족해요"
- 분야 키워드 + 요청: "주거 지원 받고 싶어요", "의료 지원이 필요해요"
- 명시적 선택: "주거 쪽으로 더 자세히", "의료 관련 지원이 궁금해요"
- "더 자세히", "구체적으로", "다른 옵션은?" 같은 후속 질문 시

호출 금지:
- 분야가 불명확하거나 여러 개일 때 (orchestrate_full_response 사용)
- 처음 상담 시작할 때 분야가 없을 때 (orchestrate_full_response 사용)

예시:
- "월세 지원이 필요해요" → domain: "주거·월세"
- "고정지원이 절실해요" → domain: "생활 유지"
- "주거가 너무 힘들어요" → domain: "주거·월세"
- "생활비가 부족해요" → domain: "생활 유지"
- "의료 지원 받고 싶어요" → domain: "의료·돌봄"
- "취업 관련 지원이 궁금해요" → domain: "고용·교육"

출력: 각 카드의 "이게 뭐냐면", "왜 지금 맞냐면", "지금 하실 수 있는 말", "어디로", "막히면" 정보

파라미터
domain: "주거·월세" | "생활 유지" | "의료·돌봄" | "고용·교육" | "심리·정서" | "문화·여가" | "평생교육" | "참여·활동"
generate_action_steps
용도
선택한 지원에 대한 실행 계획 제공 (오늘/내일/막히면 3단계).
호출 시점:
- "구체적으로 어떻게 해요?", "방법 알려주세요" 요청
- "오늘 바로 할 수 있는 게 뭐예요?" 질문
- 카드 선택 후 실행 방법이 궁금할 때
- "시작하려면 어떻게 하나요?" 같은 실행 의도

예시:
- "구체적으로 어떻게 시작하나요?"
- "오늘 바로 할 수 있는 일이 뭐예요?"
- "실행 계획을 알려주세요"
- "당장 뭐부터 하면 돼요?"

호출 금지:
- 아직 카드를 선택하지 않았을 때
- orchestrate_full_response가 이미 행동 단계를 포함한 경우
- 단순 정보 질문 단계

출력: today(오늘 할 일), tomorrow(내일까지), fallback(막히면 대안)

generate_fallback_paths
용도
전화 연결 실패, 서류 부족, 자격 애매할 때의 대안 경로 제시 (한국 공공 지원).
호출 시점:
- "전화가 안 돼요", "연결이 안 되는데요" 호소
- "서류가 없어요", "준비가 어려워요" 어려움 표현
- "자격이 안 될 것 같은데", "조건이 애매한데" 걱정
- 실행 중 실제 문제 발생했을 때

예시:
- "전화 연결이 안 되는데 어떻게 해요?"
- "서류 준비가 너무 어려워요"
- "자격이 애매한데 다른 방법은?"
- "담당자가 안 받는데요"

호출 금지:
- 아직 시도하지 않았을 때
- 문제 상황이 실제로 발생하지 않았을 때
- 단순 걱정이나 예상 (실제 막힘 발생 후 호출)

출력: 전화/서류/자격 각 상황별 구체적인 대안 경로

compose_safe_response
용도
응답 마지막에 붙는 감정 안전 메시지 생성 (한국 공공 지원).
호출 시점:
- orchestrate_full_response가 ⑦단계에서 자동으로 포함함
- 개별적으로 감정 지원 메시지만 필요할 때 (매우 드묾)
- 사용자가 불안이나 압박을 표현했을 때

예시 (드묾):
- "무서워요"
- "너무 불안해요"
- "걱정돼요"

대부분의 경우:
- 단독 호출 불필요
- orchestrate_full_response가 자동으로 처리
- 일반적인 상담에서는 호출 금지

출력: 상황에 맞는 감정 안전 메시지 (비판단적, 지지적 톤)

collect_region_context
용도
한국 지역(시/도/군/구) 정보를 수집하여 지역별 지원 안내에 활용.
호출 시점:
- 사용자가 지역 정보를 명시적으로 제공했을 때
- 지역별 지원 차이를 확인해야 할 때
- "OO에 살아요", "OO 거주" 같은 지역 언급

예시:
- "서울 강남구에 살아요"
- "천안 두정동이에요"
- "부산 사상구입니다"
- "경기도 수원시 거주 중이에요"

호출 금지:
- 사용자가 지역 정보를 언급하지 않았을 때
- 이미 지역 정보가 수집되었을 때 (중복 방지)
- 지역과 무관한 일반 질문

출력: collected(수집 성공 여부), region(지역명), message(안내 메시지)

파라미터
user_input: string
reveal_policy_name_if_triggered
용도
사용자가 특정 혜택 카드의 정확한 제도명을 물어볼 때 제도명 공개 (한국 공공 지원).
호출 시점:
- 카드 선택 신호: "1번이 뭐예요?", "첫 번째 할게요", "2번 선택할게요"
- 제도명 직접 질문: "정확한 이름이 뭐예요?", "제도명 알려주세요", "무슨 제도예요?"
- 행동 의도 표현: "어디로 전화해야 해요?", "신청 방법은?", "연락처 알려주세요"

예시:
- "1번이 정확히 뭐예요?"
- "첫 번째 거 선택할게요"
- "이거 정확한 제도 이름 알려주세요"
- "어떻게 신청하나요?"
- "어디로 전화하면 돼요?"

호출 금지:
- 아직 혜택 카드를 제시하지 않았을 때
- 일반적인 지원 정보 질문 (orchestrate_full_response 사용)
- 분야 선택 단계

출력: triggered(트리거 감지 여부), policy_name(제도명), message(안내 메시지)

파라미터
message: string
suggest_followup_options
용도
현재 선택한 지원 외에 추가로 살펴볼 수 있는 지원 분야 제안 (한국 공공 지원).
호출 시점:
- "또 뭐가 있어요?", "다른 지원도 궁금해요" 질문
- 한 가지 지원을 마무리하고 확장하려 할 때
- "다른 건 없어요?", "추가로 받을 수 있는 거" 같은 추가 탐색 의도

예시:
- "또 받을 수 있는 지원이 있나요?"
- "다른 것도 궁금해요"
- "주거 말고 다른 분야는 뭐가 있어요?"
- "추가로 알아볼 만한 게 있을까요?"

호출 금지:
- 첫 상담 시작 단계 (orchestrate_full_response 사용)
- orchestrate_full_response가 이미 ⑥확장 안내를 포함한 경우
- 아직 하나도 선택하지 않았을 때

출력: followup_domains(추가 분야 리스트), message(안내 메시지)